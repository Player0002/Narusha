Timer 2 Overflow Interrupt
=> PWM을 구현

PWM이 주기 10ms 10% Duty 그럼 Duty는? 1ms
10 ms 를 100단계로 나누면 : 한단계는? 100 Ms ( 1단계 )

100 Ms 마다 인터럽트를 시키기 위해 100 Ms 마다 카운트 해야한다.

16 MHz 8분주 - 2MHz ( 주기 : 반마이크로 ) 

얼마만에 인터럽트가 필요한가? 100Ms 마다
0.5Ms 가 몇개가 되야하나? 200개. 
TcNT = 200 개
OverFlow Intterupt 는 255일때 발생함. 항상
200개째때 발생해야 하므로 56 부터 시작을 해야지 200개 마다 인터럽트 발생

TCNT라는 레지스터는 우리가 RW 할 수 있고, 기본적으로 타이머라는 하드웨어가 카운트를 한다. TCNT는 반마이크로마다 카운트 된다. ( 주기 마다 ) 

TCNT = 56 을 넣어주면 56부터 시작함.
그럼 항상 인터럽트 발생하면 TCNT는 0으로 돌아가야함. 
ISR 루틴 안에서 실행할 필요가 있음. 그 안에서 56을 넣어줘야함
ISR은 Intterupt 가 발생하면 들어가게 된다.

ISR은 소프트웨어적으로 발생하게 된다.

Intterupt Service ruttine
인터럽트 서비스 루틴

그럼 ISR안ㅇ서 해야하는건 COUNT를 ++를 해서 100개면 0으로 떨구고 HIGH, 10 개면 LOW 로 만들어야함 그럼 TCCR Timer2 이용

TCCR2A = 0x00 ; //f
TCCR2B = 0x02 ; // Normal Mode
TCNT2 = 56;

ISR(TIMER2_OVF_vect){
	TCNT2 = 56;
	count++
	if(count == 100){
		count = 0;
		digitalWrite(13, HIGH);
	}else if(count == 10){
		digitalWrite(13, LOW);
	}
}
지금까지는 Overflow 인터럽트 였습니다

255 -> 0 255 -> 0 이렇게 반복됬습니다.
255 일때 OVF Int 가 발생합니다.
Capture 뭐시기는 내가 원하는 지점에서 인터럽트를 발생시킵니다.
100 -> 0 100 -> 0 이런것이 가능합니다.
Capture Compare Intterupt 입니다.  
지금까진 TCCR2B 에서 Normal 모드를 이용했습니다.
CTC 모드를 이용해봅시다.
CTC 모드란? 세팅은 010 으로 되어있습니다.
CTC 모드가 우리가 값을 세팅하면 카운트가 0 부터 그 값이 match 가 되면 인터럽트 이후 0으로 돌아갑니다.
그 값을 어디에 세팅하느냐?
OCR2A 라는 곳에 세팅하면 됩니다.
똑같이 255까지 세팅할 수 있습니다.
100을 세팅하면 100일떄 매치 이후 0으로 돌아갑니다.
TIMSK 를 보면 OCR output compare match A 가 있습니다. Match B 도 존재합니다.
그럼 이곳에 하나는 100을 세팅하고 하나는 200을 세팅하면 100일때 0이 나오면 200까지는 영원히 가지 않습니다. 그러면 MAX가 뭐냐면 여기 이제 설명을 하자면 아직 모두 다 이해하지 않아도 됩니다. 우선은 노력하세여
TOP은 무엇이냐? 젤 높은 값. MAX = 0xFF BOTTOM = 0x00 TOP 은 끝까지 올라가는 값입니다.
CTC 모드는 보면 OCRA 가 들어가고 Normal 모드는 0xFF 가 박혀있습니다.
100 하고 200 에서 2개의 인터럽트를 발생시키고 싶다면 OCRA 는 200이 되야합니다.
OCRB = 100 이 되야하고요.

Output compare match 비교해서 match가 일어나면 인터럽트가 발생합니다.
overflow는 하나 compare match는 2개가 발생할 수 있습니다.
타이머 마스크 2를 보면 인터럽트를 2개 세팅할 수 있습니다.
OCRA OCRB MAX 값을 둘다 쓴다 하면 높은값을 A에 세팅해야 합니다.
100 Ms 마다 ++ 를해서 100개면 HIGH 10개면 LOW 했는데 COmpareMatch를 이용하면 똑같이 100Ms일때 인터럽트를 발생시키고 싶다면 0부터 시작해서 200개일때 인터럽트를 발생시키면 됩니다.
OCRA = 200 이렇게 세팅하면 되는겁니다.

다음에는 FAST PWM 2개를 합칠껀데
지금은 살펴보고 넘어갑시다.

그럼 우선 0x02로 TIMSK2 를 세팅합니다
ISR 이름은 달라집니다.
ISR(TIMER2_COMPA_vect){
}
위와 같이 세팅할경우 OCR2A를 세팅할 필요가 있다.

OCR2A 의 값에 따라 어디서 인터럽트가 일어나는지가 달라집니다.
100 으로 바꾸게 될경우 200이아니라 100에서 인터럽트가 발생하게 되므로
속도는 조금 빨라져야합니다.

10ms 100단계 -> 100Ms , 반마이크로 마다 200 개를 해야 10ms 가 나오는데
100개를 카운트 하게 된다면 주기가 5ms 가 나오게 됩니다.
그러면 우리 눈으로는 확인하기가 힘들어집니다.

주기계산 연습하기 ★

FAST PWM이 뭔가요?
011로 우선 세팅을 합니다.
TOP이 CTC 에서는 OCRA 였는데 FAST PWM은 0xFF 까지 가게 됩니다.
그리고 2가지 255까지 오버플로우를 발생시키고 OCR과 매치되는 인터럽트까지
2개가 발생하게 됩니다.
이걸 가지고 무엇을 하느냐? 반마이크로 에서 100 마이크로가 될려면 200개 카운트를 해야하죠? 근데 여기서 보면 지금 우리가 지금 마늗ㄹ려고하는 그건 10ms 그건데 주기를 2ms 로 줘볼까요? 주기를 2ms 로 하면 똑같이 이렇게 되는데 0~n 까지가 2ms 가 되고
인터럽트를 2번만 발생시킵니다.
올라갈때 한번 내려갈때 한번
인터럽트가 많이 발생할수록 부하가 많이 걸립니다.
2ms 주기로 duty 100% 로 만들어 봅시다.
2ms 를 오버플로우때 내리고 Capture일때 내리겠다는 겁니다.
Overflow 2ms 째때 인터럽트가 발생해ㅑ 겠네요. count ++ 이 아닌 2ms 마다 올리겠다는 겁니다. 2ms 오버플로우 만들려면 어떻게 세팅해야 할까요?
0.5Ms 가 2ms 가 될려면 4000개가 있어야 하겠죠? 2ms = 2000Ms 그렇다면 반마이크로가 아니라 그러면 32마이크로네 주기 2Ms 2Ms가 2ms 될려면 1000개
64일땐 250개. 250개 째때 올리게 되네요
주기가 얼마? 8Ms 10% 듀티 만들려면? 10% Duty 는 얼마? 200Ms 일때 이죠 200Ms 될려면 8Ms 가 25개 그럼 간격은 몇간격으로 ? 250단계로 
다음주는 수요일 저녁, 목요일 그렇게 하도록 하겠습니다.
250단계는 만들 수 있겠네요
100단계 만들려면? 2.5씩 증가시키면 되겠네요
그럼 이걸 어디에 세팅을 하느냐
10%면 시간 200Ms 죠 Count 25개 10%면 25개네요. 그걸 어디에 세팅해야할까요?
Overflow 는 2ms 마다 무조건 올리는데
10%이면 내려야해요. 언제 내리냐 count 가 25일때 내려? 어디 ISR에서? 그래서 OCR 값을 조정해서 25로 세팅해두면 0부터 25개 되면 인터럽트가 발생하겠죠. 그때 들어가서 내려가면 되요. 그럼 인터럽트 2번만 발생하면 되겠네요. 굉장히 효율적이죠.
그래서 Fast PWM은 101로 분주기를 세팅하고, 모드는 FAST PWM으로 바꿉니다. 011 입니다. 그러면 
